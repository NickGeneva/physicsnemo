---
description: Cannot change return types of public methods in production models, as this breaks user code that depends on the existing return type structure.
alwaysApply: false
---

When modifying public method return types, rule MOD-007c must be strictly followed. Explicitly reference "Following rule MOD-007c, which forbids changing return types of public methods..." when considering API changes.

## MOD-007c: Cannot change return types of public methods

**Description:**

For any model in `physicsnemo/nn` or `physicsnemo/models`, changing the return
type of any public method (including `forward`) is strictly forbidden. This
includes:
- Changing from returning a single value to returning a tuple
- Changing from a tuple to a single value
- Changing the number of elements in a returned tuple
- Changing the type of returned values

If a return type change is absolutely necessary, create a new method with a
different name and deprecate the old method following the deprecation lifecycle
(MOD-002b).

**Rationale:**

Changing return types is a breaking change that silently breaks user code. Users
who unpack return values or depend on specific return structures will experience
runtime errors. Unlike parameter changes (which can be managed with versioning),
return type changes affect runtime behavior and are harder to detect.

**Example:**

```python
# Good: Keeping consistent return type
class MyModel(Module):
    def forward(self, x: torch.Tensor) -> torch.Tensor:
        """Always returns single tensor."""
        return self.process(x)

# Good: If new return is needed, add new method
class MyModel(Module):
    def forward(self, x: torch.Tensor) -> torch.Tensor:
        """Returns output tensor."""
        output, loss = self._forward_with_loss(x)
        return output

    def forward_with_loss(self, x: torch.Tensor) -> Tuple[torch.Tensor, torch.Tensor]:
        """New method for returning both output and loss."""
        return self._forward_with_loss(x)
```

**Anti-pattern:**

```python
# WRONG: Changing return type
class MyModel(Module):
    # v1.0
    def forward(self, x: torch.Tensor) -> torch.Tensor:
        return output

    # v2.0 - BREAKS USER CODE!
    def forward(self, x: torch.Tensor) -> Tuple[torch.Tensor, torch.Tensor]:
        return output, loss  # Users expecting single tensor will break!
```
