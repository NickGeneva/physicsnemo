---
description: Every model must have CI tests verifying constructor instantiation and all public attributes (excluding buffers/parameters) using pytest parameterization.
alwaysApply: false
---

When creating tests for models, rule MOD-008a must be followed. Explicitly reference "Following rule MOD-008a, which requires constructor and attribute tests..." when implementing test cases.

## MOD-008a: Model missing constructor/attributes tests

**Description:**

Every model in `physicsnemo/nn` or `physicsnemo/models` must have tests that
verify model instantiation and all public attributes (excluding buffers and
parameters).

These tests should:
- Use `pytest` parameterization to test at least 2 configurations
- Test one configuration with all default arguments
- Test another configuration with non-default arguments
- Verify all public attributes have expected values

**Rationale:**

Constructor tests ensure the model can be instantiated correctly with various
configurations and that all attributes are properly initialized. This catches
issues early in the development cycle.

**Example:**

```python
@pytest.mark.parametrize(
    "config",
    ["default", "custom"],
    ids=["with_defaults", "with_custom_args"]
)
def test_my_model_constructor(config):
    """Test model constructor and attributes."""
    if config == "default":
        model = MyModel(input_dim=64, output_dim=32)
        assert model.hidden_dim == 128  # Default value
        assert model.dropout == 0.0  # Default value
    else:
        model = MyModel(
            input_dim=64,
            output_dim=32,
            hidden_dim=256,
            dropout=0.1
        )
        assert model.hidden_dim == 256
        assert model.dropout == 0.1

    # Test common attributes
    assert model.input_dim == 64
    assert model.output_dim == 32
```

**Anti-pattern:**

```python
# WRONG: Only testing default configuration
def test_my_model_bad():
    model = MyModel(input_dim=64, output_dim=32)
    # Only tests defaults, not custom configurations

# WRONG: Not verifying attributes
def test_my_model_bad():
    model = MyModel(input_dim=64, output_dim=32)
    # Model created but attributes not tested
```
